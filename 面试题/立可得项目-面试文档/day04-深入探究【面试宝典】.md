# 第4章 深入探究【面试宝典】

## 1.在项目中用了哪种设计模式？在什么场景下使用的？

策略模式。在立可得系统中，使用策略模式设计了消息分发处理架构。

在微服务启动后，会自动从spring容器中获取所有实现了消息处理接口的类，并获取该类的@Topic注解中的值，也就是EMQ消息主题，然后构建一个Map集合，以主题作为key，以消息处理类作为值。  在微服务接收到消息后，就会根据主题找到对应的消息处理类来进行处理。这样做，可以避免在接收消息后，用一堆if进行判断。



## 2. 项目中为什么使用EMQ作为消息中间件？(优势)

EMQX 目前为开源社区中最流行的 MQTT 消息中间件，在各种客户严格的生产环境上经受了严苛的考验；

EMQX 支持丰富的物联网协议，包括 MQTT、MQTT-SN、CoAP、 LwM2M、LoRaWAN 和 WebSocket 等；

优化的架构设计，支持超大规模的设备连接。企业版单机能支持百万的 MQTT 连接；集群能支持千万级别的 MQTT 连接；

易于安装使用、灵活的扩展性并且支持中国本地技术。

## 3. 什么是共享订阅？在项目中的场景。

微服务之间异步调用都是采用EMQ的共享订阅，因为我们要微服务集群只有一个节点可以获取到消息。

如果不采用共享订阅，则是广播的方式，那么某个微服务集群的节点都会收到消息，业务就会重复处理。
